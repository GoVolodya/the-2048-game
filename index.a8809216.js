!function(){var t="Restart",e={};function s(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var r=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_STATE;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t,this.state=this.deepCloneArray(this.initialState),this.setStatus(),this.setScore()}return t=[{key:"moveLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getStatus()===e.STATUS_PLAYING){for(var s=this.deepCloneArray(e.DEFAULT_STATE),r=0;r<this.state.length;r++){for(var a=[],i=0;i<this.state[r].length;i++)0!==this.state[r][i]&&a.push(this.state[r][i]);for(var n=[];a.length>0;){var h=a.shift();if(a.length>0&&h===a[0]){var o=2*h;t||this.setScore(this.getScore()+o),n.push(o),a.shift()}else n.push(h)}for(var l=0;n.length>0;)s[r][l]=n.shift(),l++}if(!this.compareArrays(this.state,s)){if(t)return!0;this.state=s,this.checkForWin(),this.populateEmptyCell()}if(t)return!1;this.hasOtherMoves()||this.getStatus()===e.STATUS_WIN||this.gameOver()}}},{key:"moveRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getStatus()===e.STATUS_PLAYING){for(var s=this.deepCloneArray(e.DEFAULT_STATE),r=0;r<this.state.length;r++){for(var a=[],i=0;i<this.state[r].length;i++)0!==this.state[r][i]&&a.push(this.state[r][i]);for(var n=[];a.length>0;){var h=a.pop();if(a.length>0&&h===a[a.length-1]){var o=2*h;t||this.setScore(this.getScore()+o),n.push(o),a.pop()}else n.push(h)}for(var l=this.state[r].length-1;n.length>0;)s[r][l]=n.shift(),l--}if(!this.compareArrays(this.state,s)){if(t)return!0;this.state=s,this.checkForWin(),this.populateEmptyCell()}if(t)return!1;this.hasOtherMoves()||this.getStatus()===e.STATUS_WIN||this.gameOver()}}},{key:"moveUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getStatus()===e.STATUS_PLAYING){for(var s=this.deepCloneArray(e.DEFAULT_STATE),r=0;r<this.state.length;r++){for(var a=[],i=0;i<this.state[r].length;i++)0!==this.state[i][r]&&a.push(this.state[i][r]);for(var n=[];a.length>0;){var h=a.shift();if(a.length>0&&h===a[0]){var o=2*h;t||this.setScore(this.getScore()+o),n.push(o),a.shift()}else n.push(h)}for(var l=0;n.length>0;)s[l][r]=n.shift(),l++}if(!this.compareArrays(this.state,s)){if(t)return!0;this.state=s,this.checkForWin(),this.populateEmptyCell()}if(t)return!1;this.hasOtherMoves()||this.getStatus()===e.STATUS_WIN||this.gameOver()}}},{key:"moveDown",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getStatus()===e.STATUS_PLAYING){for(var s=this.deepCloneArray(e.DEFAULT_STATE),r=0;r<this.state.length;r++){for(var a=[],i=0;i<this.state[r].length;i++)0!==this.state[i][r]&&a.push(this.state[i][r]);for(var n=[];a.length>0;){var h=a.pop();if(a.length>0&&h===a[a.length-1]){var o=2*h;t||this.setScore(this.getScore()+o),n.push(o),a.pop()}else n.push(h)}for(var l=this.state.length-1;n.length>0;)s[l][r]=n.shift(),l--}if(!this.compareArrays(this.state,s)){if(t)return!0;this.state=s,this.checkForWin(),this.populateEmptyCell()}if(t)return!1;this.hasOtherMoves()||this.getStatus()===e.STATUS_WIN||this.gameOver()}}},{key:"getScore",value:function(){return this.score}},{key:"setScore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.score=t}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_STATE;this.state=t}},{key:"getStatus",value:function(){return this.status}},{key:"setStatus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.STATUS_IDLE;this.status=t}},{key:"start",value:function(){this.setStatus(e.STATUS_PLAYING),this.setScore(),this.populateEmptyCells()}},{key:"restart",value:function(){this.setScore(),this.setStatus(),this.state=this.deepCloneArray(this.initialState),this.compareArrays(this.initialState,e.DEFAULT_STATE)&&this.populateEmptyCells()}},{key:"isFour",value:function(){return .1>Math.random()}},{key:"getNewEmptyCellNumber",value:function(){return this.isFour()?4:2}},{key:"getEmptyCells",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push([e,s]);return t}},{key:"populateEmptyCell",value:function(){var t=this.getEmptyCells(),e=Math.floor(Math.random()*t.length),s=t[e][0],r=t[e][1];this.state[s][r]=this.getNewEmptyCellNumber()}},{key:"populateEmptyCells",value:function(){for(var t=1;t<=2;t++)this.populateEmptyCell()}},{key:"compareArrays",value:function(t,e){for(var s=0;s<t.length;s++)for(var r=0;r<t[s].length;r++)if(void 0===e[s][r]||t[s][r]!==e[s][r])return!1;return!0}},{key:"hasOtherMoves",value:function(){return this.moveDown(!0)||this.moveUp(!0)||this.moveLeft(!0)||this.moveRight(!0)}},{key:"gameOver",value:function(){this.setStatus(e.STATUS_LOSE)}},{key:"gameWon",value:function(){this.setStatus(e.STATUS_WIN)}},{key:"checkForWin",value:function(){for(var t=0;t<this.state.length;t++)for(var s=0;s<this.state[t].length;s++)if(this.state[t][s]===e.WIN_NUMBER){this.gameWon();break}}},{key:"deepCloneArray",value:function(t){return t.map(function(t){return t.slice()})}}],function(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e.prototype,t),e}();s(r,"WIN_NUMBER",2048),s(r,"STATUS_PLAYING","playing"),s(r,"STATUS_IDLE","idle"),s(r,"STATUS_LOSE","lose"),s(r,"STATUS_WIN","win"),s(r,"DEFAULT_STATE",[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);var a=new(e=r),i=document.querySelector(".start"),n=document.querySelector(".message-start");function h(){for(var t=a.getState(),e=document.querySelector(".game-field"),s=0;s<t.length;s++)for(var r=0;r<4;r++){var i=e.rows[s].cells[r],n=i.className.split(/\s/).filter(function(t){return!t.startsWith("field-cell--")});i.className=n.join(" "),0===t[s][r]?i.textContent="":(i.classList.add("field-cell--".concat(t[s][r])),i.textContent=t[s][r])}}function o(){document.querySelector(".game-score").textContent=a.getScore().toString()}function l(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=document.querySelector(".message-lose");t?e.classList.remove("hidden"):e.classList.add("hidden")}function u(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=document.querySelector(".message-win");t?e.classList.remove("hidden"):e.classList.add("hidden")}i.addEventListener("click",function(e){e.target.textContent===t?a.restart():(a.start(),i.textContent=t,n.classList.add("hidden")),l(),u(),h(),o()}),document.addEventListener("keydown",function(t){if(a.getStatus()===e.STATUS_IDLE&&a.setStatus(e.STATUS_PLAYING),a.getStatus()===e.STATUS_PLAYING){switch(t.preventDefault(),t.key){case"ArrowUp":a.moveUp();break;case"ArrowDown":a.moveDown();break;case"ArrowRight":a.moveRight();break;case"ArrowLeft":a.moveLeft()}a.getStatus()===e.STATUS_LOSE&&(l(!0),u()),a.getStatus()===e.STATUS_WIN&&(u(!0),l()),h(),o(),a.hasOtherMoves()||(a.gameOver(),l(!0),u())}})}();
//# sourceMappingURL=index.a8809216.js.map
